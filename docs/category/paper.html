<!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width">
  <title>Thamme Gowda - Paper</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <!--<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Tangerine">-->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css">
    <link rel="stylesheet" href="https://isi.edu/~tg/theme/css/main.557acf99.css">
  <style media="print">.is-hidden-print{display:none !important}</style>
      <link rel="stylesheet" href="https://isi.edu/~tg/css/custom.css">
</head>

<body id="index" class="home">
<header class="hero is-primary">
  <div class="hero-head">
    <div class="container">
      <nav class="navbar">
        <div class="navbar-brand">
          <a class="navbar-item title is-3"
             href="https://isi.edu/~tg/">Thamme Gowda</a>
        </div>
      </nav>
    </div>
  </div>
</header>

<nav class="navbar has-shadow is-hidden-print">
  <div class="container">
    <div class="navbar-center"></div>
    <span id="navToggle" class="navbar-burger">
      <span></span>
      <span></span>
      <span></span>
    </span>
    <div id="navMenu" class="navbar-menu">
        <div class="navbar-end">
            <a class="navbar-item is-tab" href="https://isi.edu/~tg">Home</a>
            <a class="navbar-item is-tab" href="https://isi.edu/~tg/posts">Blog</a>
            <a class="navbar-item is-tab" href="https://isi.edu/~tg/software">Software</a>
            <a class="navbar-item is-tab" href="https://isi.edu/~tg/publications.html">Publications</a>
            <a class="navbar-item is-tab" href="https://isi.edu/~tg/notes">Notes</a>
        </div>
    </div>
  </div>
</nav>

<div class="container">
  <div class="section columns">
    <article class="column is-four-fifths-desktop is-three-quarter-tablet has-text-justified">
      <aside id="featured" class="body">
        <article>
          <h1 class="title">
            <a href="https://isi.edu/~tg/posts/2021/04/mtdata-nlcodec-rtg-many-english/">Many-to-English Machine Translation Tools, Data, and Pretrained Models</a>
          </h1>
<footer class="post-info">
  <abbr class="published" title="2021-04-25T10:20:00-07:00">
    Published <span class="is-info">25 April 2021</span>
    in <a href="https://isi.edu/~tg/category/paper.html">Paper</a>
  </abbr>

    <p class="author">
      <em>by           <a class="url fn" href="https://isi.edu/~tg/author/thamme-gowda.html">Thamme Gowda <tg@isi.edu></a>
</em>
      <span class="tag is-small is-rounded">
        <a href="https://isi.edu/~tg/tag/nmt.html">NMT</a>
      </span>
    </p>
  
</footer>          <div class="section">
              <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><em>Collaborators: Zhao Zhang, Chris A Mattmann, and Jonathan May</em></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_abstract">Abstract</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We present useful tools for machine translation research: MTData, NLCodec, and RTG.
We demonstrate their usefulness by creating a multilingual neural machine translation model capable of translating from 500 source languages to English.
We make this multilingual model readily downloadable and usable as a service, or as a parent model for transfer-learning to even lower-resource languages.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_links">Links</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Paper: <a href="https://arxiv.org/abs/2104.00290" class="bare">https://arxiv.org/abs/2104.00290</a>  <a href="https://arxiv.org/pdf/2104.00290" target="_blank" rel="noopener"><span class="icon red"><i class="fa fa-download fa-2x"></i></span></a></p>
</li>
<li>
<p><strong class="big red yellow-background">Demo: <a href="http://rtg.isi.edu/many-eng/v1/" target="_blank" rel="noopener">üëâüèºMany-to-English translationüëàüèºüî•</a></strong></p>
</li>
</ul>
</div>
<div class="videoblock">
<div class="content">
<iframe width="640" height="400" src="https://www.youtube.com/embed/NSY0-MvO1KE?rel=0" frameborder="0" allowfullscreen></iframe>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_summary">Summary</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We announce three tools for machine translation:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">MTData</dt>
<dd>
<p>A tool to download machine translation datasets
<a href="https://github.com/thammegowda/mtdata/" class="bare">https://github.com/thammegowda/mtdata/</a><br>
 <code>pip install mtdata</code></p>
</dd>
<dt class="hdlist1">NLCodec</dt>
<dd>
<p><a href="https://isi-nlp.github.io/nlcodec/" class="bare">https://isi-nlp.github.io/nlcodec/</a><br>
<code>pip install nlcodec</code></p>
</dd>
<dt class="hdlist1">RTG</dt>
<dd>
<p><a href="https://isi-nlp.github.io/rtg/" class="bare">https://isi-nlp.github.io/rtg/</a><br>
<code>pip install rtg</code></p>
</dd>
</dl>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Scripts, tables, and charts: <a href="https://github.com/thammegowda/006-many-to-eng" class="bare">https://github.com/thammegowda/006-many-to-eng</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Using these tools we first, collected a massive dataset.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Download Data</dt>
<dd>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>From <a href="http://rtg.isi.edu/many-eng/data-v1.html" class="bare">http://rtg.isi.edu/many-eng/data-v1.html</a>.</p>
</li>
<li>
<p>Also available from OPUS <a href="https://opus.nlpl.eu/MT560.php" class="bare">https://opus.nlpl.eu/MT560.php</a></p>
</li>
</ol>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>And then we trained massively multilingual models for many-to-English translation.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Download Models</dt>
<dd>
<p><a href="http://rtg.isi.edu/many-eng/models/" class="bare">http://rtg.isi.edu/many-eng/models/</a></p>
</dd>
</dl>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Recommended: <a href="http://rtg.isi.edu/many-eng/models/rtg500eng-tfm9L6L768d-bsz720k-stp200k-ens05.tgz">rtg500eng-tfm9L6L768d-bsz720k-stp200k-ens05.tgz</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We provide a docker image with pretrained model which can be readily usable as a translation service:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash"># pick the latest image from https://hub.docker.com/repository/docker/tgowda/rtg-model
IMAGE=tgowda/rtg-model:500toEng-v1

# To run without using GPU; requires about 5 to 6GB CPU RAM
docker run --rm -i -p 6060:6060 $IMAGE

# Recommended: use GPU (e.g. device=0)
docker run --gpus '"device=0"' --rm -i -p 6060:6060 $IMAGE</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you prefer to not use docker, then</p>
</div>
<div class="paragraph">
<p><strong>Step 1:</strong> Setup a <code>conda</code> environment and install <code>rtg</code> library.<br></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If <code>conda</code> is missing in your system, <a href="https://docs.conda.io/en/latest/miniconda.html" target="_blank" rel="noopener">please install miniconda</a> to get started.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">conda create -n rtg python=3.7
conda activate rtg
pip install rtg==0.5.0  # install rtg and its dependencies
conda install -c conda-forge uwsgi  # needed to deploy service</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Download a model and run</div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash"># Pick the latest version
MODEL=rtg500eng-tfm9L6L768d-bsz720k-stp200k-ens05.tgz
wget http://rtg.isi.edu/many-eng/models/$MODEL

tar xvf $MODEL    # Extract and run
uwsgi --http 127.0.0.1:6060 --module rtg.serve.app:app --pyargv "/path/to/extracted/dir"
# Alternatively, without uWSGI (not recommended)
# rtg-serve /path/to/extracted/dir
# See "rtg-serve -h" to learn optional arguments for --pyargv "&lt;here&gt;" of uWSGI</code></pre>
</div>
</div>
<div class="ulist">
<div class="title">Interaction with REST API</div>
<ul>
<li>
<p>Web Interface: a simple web interface is made at <a href="http://localhost:6060" class="bare">http://localhost:6060</a>.</p>
</li>
<li>
<p>REST API is available at <a href="http://localhost:6060/translate" class="bare">http://localhost:6060/translate</a>.<br>
An example interaction with REST API:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>API=http://localhost:6060/translate
curl $API --data "source=Comment allez-vous?" \
   --data "source=Bonne journ√©e"

# API also accepts input as JSON data
curl -X POST -H "Content-Type: application/json" $API\
  --data '{"source":["Comment allez-vous?", "Bonne journ√©e"]}'</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To learn more about RTG service and how to interact with it, go to <a href="https://isi-nlp.github.io/rtg/#_rtg_serve" target="_blank" rel="noopener">RTG Docs</a>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Decoding in Batch Mode</div>
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash"># `pip install rtg==0.5.0` should have already installed sacremoses-xt
pip install sacremoses-xt==0.0.44
sacremoses normalize -q -d -p -c tokenize -a -x -p :web: &lt; input.src &gt; input.src.tok

CUDA_VISIBLE_DEVICES=0   # set GPU device ID
rtg-decode /path/to/model-extract -if input.src.tok -of output.out

# post process; drop &lt;unk&gt;s, detokenize
cut -f1 output.out | sed 's/&lt;unk&gt;//g' | sacremoses detokenize &gt; output.out.detok</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Parent-Child Transfer for Low Resource MT</div>
<p>The pretrained model can be adopted to a specific dataset, using parent-child transfer setup.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<a href="https://isi-nlp.github.io/rtg/#conf-parent-child" target="_blank" rel="noopener">Refer to RTG documentation for parent-child transfer</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Learning rate of child model trainer is a crucial parameter: higher learning rate would destroy parent model&#8217;s weights, and lower learning rate means less adaptation to child dataset.
Hence, learning rate has to be just right; refer to <code>conf.yml</code> files in <a href="https://github.com/thammegowda/006-many-to-eng/tree/master/lowres-xfer" class="bare">https://github.com/thammegowda/006-many-to-eng/tree/master/lowres-xfer</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_citation">Citation</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://aclanthology.org/2021.acl-demo.37/" class="bare">https://aclanthology.org/2021.acl-demo.37/</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre>@inproceedings{gowda-etal-2021-many,
    title = "Many-to-{E}nglish Machine Translation Tools, Data, and Pretrained Models",
    author = "Gowda, Thamme  and
      Zhang, Zhao  and
      Mattmann, Chris  and
      May, Jonathan",
    booktitle = "Proceedings of the 59th Annual Meeting of the Association for Computational Linguistics and the 11th International Joint Conference on Natural Language Processing: System Demonstrations",
    month = aug,
    year = "2021",
    address = "Online",
    publisher = "Association for Computational Linguistics",
    url = "https://aclanthology.org/2021.acl-demo.37",
    doi = "10.18653/v1/2021.acl-demo.37",
    pages = "306--316",
}</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_acknowledgements">Acknowledgements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Thanks to USC CARC, and TACC for providing computing resources.
Thanks to J√∂rg Tiedemann for hosting the dataset at OPUS.</p>
</div>
</div>
</div>
          </div>
        </article>
      </aside>
  <div class="is-hidden-print">
    <h2 class="subtitle">Other articles</h2>
    <div class="columns is-multiline">
        <div class="column is-half-tablet is-one-third-desktop">
          <div class="card is-fullwidth is-fullheight">
            <div class="card-content">
              <a href="https://isi.edu/~tg/posts/2021/03/macroavg-rare-types-important/">
                <h3 class="title is-5">Macro-Average: Rare Types Are Important Too</h3>
                <div class="heading subtitle">11 March 2021</div>
                <div><p>Macro-Average: Rare Types Are Important Too</p></div>
              </a>
            </div>
          </div>
        </div>
        <div class="column is-half-tablet is-one-third-desktop">
          <div class="card is-fullwidth is-fullheight">
            <div class="card-content">
              <a href="https://isi.edu/~tg/posts/2020/11/2020-optimal-vocab-nmt/">
                <h3 class="title is-5">Finding the Optimal Vocabulary for Neural Machine Translation</h3>
                <div class="heading subtitle">01 November 2020</div>
                <div><p>Finding the Optimal Vocabulary for Neural Machine Translation</p></div>
              </a>
            </div>
          </div>
        </div>
    </div>
<nav class="pagination is-centered">
    <a class="pagination-previous" href="#" disabled>
      Previous
    </a>
    <a class="pagination-next" href="#" disabled>
      Next page
    </a>
  <ul class="pagination-list">
    <li>Page 1 / 1</li>
  </ul>
</nav>
<br>  </div>
    </article>

    <div class="column is-one-fifth-desktop is-one-quarter-tablet is-hidden-print">
      <aside class="menu">
          <p class="menu-label">Links</p>
          <ul class="menu-list">
              <li><a href="https://usc.edu/" target="_blank">
                <span class="icon is-small"><i class="fa fa-globe fa-fw"></i></span>
                <span class="link-text is-size-7">USC</span>
              </a></li>
              <li><a href="https://isi.edu/" target="_blank">
                <span class="icon is-small"><i class="fa fa-globe fa-fw"></i></span>
                <span class="link-text is-size-7">USC ISI</span>
              </a></li>
              <li><a href="https://viterbischool.usc.edu/" target="_blank">
                <span class="icon is-small"><i class="fa fa-globe fa-fw"></i></span>
                <span class="link-text is-size-7">USC Viterbi</span>
              </a></li>
              <li><a href="https://cs.usc.edu/" target="_blank">
                <span class="icon is-small"><i class="fa fa-globe fa-fw"></i></span>
                <span class="link-text is-size-7">USC CS Dept</span>
              </a></li>
              <li><a href="https://www.isi.edu/research_groups/nlg/home" target="_blank">
                <span class="icon is-small"><i class="fa fa-globe fa-fw"></i></span>
                <span class="link-text is-size-7">USC ISI-NLP</span>
              </a></li>
          </ul>
<p class="menu-label">Social</p>
<ul class="menu-list">
    <li><a href="mailto:" target="_blank">
      <span class="icon is-small">
          <i class="fa fa-envelope fa-fw"></i>
      </span>
      <span class="link-text is-size-7">tg@isi.edu</span>
    </a></li>
    <li><a href="https://twitter.com/thammegowda" target="_blank">
      <span class="icon is-small">
          <i class="fa fa-twitter fa-fw"></i>
      </span>
      <span class="link-text is-size-7">Twitter</span>
    </a></li>
    <li><a href="https://github.com/thammegowda" target="_blank">
      <span class="icon is-small">
          <i class="fa fa-github fa-fw"></i>
      </span>
      <span class="link-text is-size-7">Github</span>
    </a></li>
    <li><a href="https://www.linkedin.com/in/thammegowda/" target="_blank">
      <span class="icon is-small">
          <i class="fa fa-linkedin fa-fw"></i>
      </span>
      <span class="link-text is-size-7">LinkedIn</span>
    </a></li>
    <li><a href="https://stackexchange.com/users/1632148/thamme-gowda?tab=accounts" target="_blank">
      <span class="icon is-small">
          <i class="fa fa-globe fa-fw"></i>
      </span>
      <span class="link-text is-size-7">StackOverflow</span>
    </a></li>
    <li><a href="https://www.quora.com/profile/Thamme-Gowda" target="_blank">
      <span class="icon is-small">
          <i class="fa fa-quora fa-fw"></i>
      </span>
      <span class="link-text is-size-7">Quora</span>
    </a></li>
    <li><a href="https://instagram.com/thammegowda/" target="_blank">
      <span class="icon is-small">
          <i class="fa fa-instagram fa-fw"></i>
      </span>
      <span class="link-text is-size-7">Instagram</span>
    </a></li>
    <li><a href="https://www.goodreads.com/user/show/31845074-thamme-gowda" target="_blank">
      <span class="icon is-small">
          <i class="fa fa-globe fa-fw"></i>
      </span>
      <span class="link-text is-size-7">GoodReads</span>
    </a></li>
    <li><a href="https://thammegowda.wordpress.com" target="_blank">
      <span class="icon is-small">
          <i class="fa fa-wordpress fa-fw"></i>
      </span>
      <span class="link-text is-size-7">WordPress</span>
    </a></li>


</ul>      </aside>
    </div>
  </div>
</div>

<footer class="footer" style="padding: 1rem 1rem 1rem;">
  <div class="container has-text-centered">
    <!--<div class="credits">-->
      <span class="is-size-7">¬©2021 Thamme Gowda. This site is made with <a href="https://blog.getpelican.com/">Pelican</a>
        / <a href="https://github.com/textbook/bulrush">Bulrush </a> / <a href="https://bulma.io">Bulma</a>.</span>
    <!--</div>-->
  </div>
  <!---->
</footer>

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-109985365-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = 'https://ssl.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
<script type="text/javascript">
  document.getElementById('navToggle').addEventListener('click', function () {
    var nav = document.getElementById('navMenu');
    var className = nav.getAttribute('class');
    if (className == 'navbar-menu') {
      nav.className = 'navbar-menu is-active';
    } else {
      nav.className = 'navbar-menu';
    }
  });
</script>
</body>
</html>